 package me.minoneer.bukkit.bookexploit;
 
 import org.bukkit.ChatColor;
 import org.bukkit.Material;
 import org.bukkit.command.Command;
 import org.bukkit.command.CommandExecutor;
 import org.bukkit.command.CommandSender;
 import org.bukkit.entity.Player;
 import org.bukkit.inventory.ItemStack;
 
 
 
 
 public class FilterCommand
   implements CommandExecutor
 {
   private final IBookFilter bookFilter;
   
   public FilterCommand(IBookFilter bookFilter) {
     this.bookFilter = bookFilter;
   }
 
   
   public boolean onCommand(CommandSender sender, Command command, String s, String[] strings) {
	   //filtering the commands
     if (command.getName().equalsIgnoreCase("filter") && sender.hasPermission("bookfilter.filter")) {
       if (sender instanceof Player) {
         Player player = (Player)sender;
         ItemStack book = player.getItemInHand();
         
         if (book != null && book.getType() == Material.WRITTEN_BOOK) {
           ItemStack newBook = this.bookFilter.filterBook(book);
           if (newBook != null) {
             player.getInventory().addItem(new ItemStack[] { newBook });
             sender.sendMessage(ChatColor.AQUA + "A filtered version of this book has been set to your inventory");
           } else {
             sender.sendMessage(ChatColor.AQUA + "This book does not contain any illegal JSON code");
           } 
         } else {
           sender.sendMessage(ChatColor.RED + "You must hold a written book in your hand to filter");
         } 
       } else {
         sender.sendMessage(ChatColor.RED + "This command can only be used by a player!");
       } 
       return true;
     } 
     return false;
   }
 }


